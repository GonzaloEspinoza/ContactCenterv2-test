
@using Logica;
@using Entidad;
@using Entidad.Enums;
@using DataP;
@using Backend.Models;
@model List<EEmpresa>
@{
    LPermiso LPermiso = LPermiso.Instancia.LPermiso;
    List<Permiso> HijosMenu = ViewBag.PermisosH;
    bool PermisoModificar = LPermiso.TienePermisoEspecifico(HijosMenu, AccionPermiso.Modificar);
    bool PermisoEliminar = LPermiso.TienePermisoEspecifico(HijosMenu, AccionPermiso.Eliminar);
    bool PermisoListar = LPermiso.TienePermisoEspecifico(HijosMenu, AccionPermiso.Listar);
    bool PermisoVer = LPermiso.TienePermisoEspecifico(HijosMenu, AccionPermiso.Ver);

    
}
@{

         <table class="table table-striped table-bordered table-hover" id="sample_2">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>NOMBRE</th>
                        <th>LOGO</th>
                        <th>ESTADO</th>
                        <th></th>
                        <th></th>
                        <th></th>

                    </tr>
                </thead>
                <tbody>
                    @{

                        foreach (var p in Model)
                        {
                                        <tr>
                                            <td>@p.EmpresaId</td>
                                            <td>@p.Nombre</td>
                                            <td><img src="data:image/png;base64,@p.Base64Logo" alt="@p.Nombre" style="width: 50px;height: auto;" /> </td>
                                            <td>
                                                @{
                                                    if (p.Estado == (int)Estado.Habilitado)
                                                    {
                                                       
                                                            <span class="label label-sm label-success"> Habilitado </span>
                                                    }
                                                    else
                                                    {
                                                            <span class="label label-sm label-danger"> Deshabilitado </span>
                                                    }
                                                }
                                            </td>
                                            <td>
                                                @{

                                                    if (PermisoVer)
                                                    {
                                                        <a class="btn btn-outline btn-circle dark btn-sm black green-haze" href="@Url.Action("detalle", "Empresa", new { id = p.EmpresaId})">
                                                            <i class="fa fa-eye"></i> Ver
                                                        </a>
                                                    }
                                                }
                                            </td>
                                            <td>
                                                @{
                                                    if (PermisoModificar)
                                                    {
                                                        <a href="@Url.Action("Empresa", "Empresa", new { id = p.EmpresaId })" onclick="BloquearPantalla();" class="btn btn-outline btn-circle btn-sm purple">
                                                            <i class="fa fa-edit"></i> Editar
                                                        </a>
                                                    }
                                                }
                                            </td>
                                            <td>
                                                @{
                                                    if (PermisoEliminar)
                                                    {
                                                        <a onclick="changeestate('@p.Nombre','eliminar','eliminado','2','@p.EmpresaId' ,'@Url.Action("CambiarEstado", "Empresa")')" class="btn btn-outline btn-circle dark btn-sm black">
                                                            <i class="fa fa-trash-o"></i> Eliminar
                                                        </a>
                                                    }
                                                }
                                            </td>

                                        </tr>
                            }
                        
                                           
                    }
                </tbody>
            </table>


 }